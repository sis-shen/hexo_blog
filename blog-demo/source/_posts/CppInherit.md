---
layout: hexo
title: C++ç»§æ‰¿
date: 2024-09-02 15:26:20
tags: C++ ç»§æ‰¿
---
# ç»§æ‰¿çš„æ¦‚å¿µåŠå®šä¹‰

## ç»§æ‰¿çš„æ¦‚å¿µ
`ç»§æ‰¿`(inheritance)æœºåˆ¶æ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä½¿ä»£ç å¯ä»¥**å¤ç”¨**çš„æœ€é‡è¦çš„æ‰‹æ®µï¼Œå®ƒå…è®¸ç¨‹åºå‘˜åœ¨ä¿æŒåŸæœ‰ç±»ç‰¹æ€§çš„åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ï¼Œå¢åŠ åŠŸèƒ½ï¼Œè¿™æ ·äº§ç”Ÿæ–°çš„ç±»ï¼Œç§°`æ´¾ç”Ÿç±»`ã€‚ç»§æ‰¿å‘ˆç°äº†é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„`å±‚æ¬¡ç»“æ„`ï¼Œä½“ç°äº†ç”±ç®€å•åˆ°å¤æ‚çš„è®¤çŸ¥è¿‡ç¨‹ã€‚ä»¥å‰æˆ‘ä»¬æ¥è§¦çš„å¤ç”¨éƒ½æ˜¯å‡½æ•°å¤ç”¨ï¼Œç»§æ‰¿æ˜¯ç±»è®¾è®¡å±‚æ¬¡çš„`å¤ç”¨`

ä¸‹é¢ç”¨ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ¼”ç¤ºä¸€ä¸‹ç»§æ‰¿
**ç¤ºä¾‹**
```C++
#include <iostream>
#include <string>
using namespace std;

class Person
{
public:
	void Info()
	{
		printf("name:%s age:%d\n", _name.c_str(), _age);
	}
protected:
	string _name = "supdriver";
	int _age = 24;
};

class Student:public Person
{
public:
	void getID()
	{
		cout << "ID:" << _ID << endl;
	}
private:
	int _ID = 114514;
};


int main()
{
	Student stu;
	stu.Info();
	stu.getID();
	return 0;
}
```

## ç»§æ‰¿çš„ä½¿ç”¨
å½“æˆ‘ä»¬å‡†å¤‡å¥½ä¸€ä¸ª`åŸºç±»`åï¼Œä¾¿å¯å°†å…¶ç”¨äº`æ´¾ç”Ÿç±»`çš„å£°æ˜

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/Inherit.png)

ç”±å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ–°çš„æ¦‚å¿µï¼š`ç»§æ‰¿æ–¹å¼`ï¼Œè€Œä¸”å¾ˆå·§çš„æ˜¯ï¼Œå®ƒå’Œ`è®¿é—®é™å®šç¬¦`çš„å…³é”®å­—æ˜¯ä¸€ä¸€å¯¹åº”çš„

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/202409030857308.png)

å®é™…ä¸Šï¼Œå®ƒä»¬å…±åŒå†³å®šäº†åŸºç±»æˆå‘˜åœ¨æ´¾ç”Ÿç±»å†…çš„è®¿é—®é™å®šç¬¦

### ç»§æ‰¿åŸºç±»æˆå‘˜è®¿é—®æ–¹å¼çš„å˜åŒ–

| ç±»æˆå‘˜/ç»§æ‰¿æ–¹å¼       | `public`ç»§æ‰¿            | `protected`ç»§æ‰¿         | `private`ç»§æ‰¿         |
| --------------------- | ----------------------- | ----------------------- | --------------------- |
| åŸºç±»çš„`public`æˆå‘˜    | æ´¾ç”Ÿç±»çš„`public`æˆå‘˜    | æ´¾ç”Ÿç±»çš„`protected`æˆå‘˜ | æ´¾ç”Ÿç±»çš„`private`æˆå‘˜ |
| åŸºç±»çš„`protected`æˆå‘˜ | æ´¾ç”Ÿç±»çš„`protected`æˆå‘˜ | æ´¾ç”Ÿç±»çš„`protected`æˆå‘˜ | æ´¾ç”Ÿç±»çš„`private`æˆå‘˜ |
| åŸºç±»çš„`private`æˆå‘˜   | åœ¨æ´¾ç”Ÿç±»ä¸­`ä¸å¯è§`      | åœ¨æ´¾ç”Ÿç±»ä¸­`ä¸å¯è§`      | åœ¨æ´¾ç”Ÿç±»ä¸­`ä¸å¯è§`    |

#### æ€»ç»“
1. `ä¸å¯è§`:åŸºç±»privateæˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­æ— è®ºä»¥ä»€ä¹ˆæ–¹å¼ç»§æ‰¿éƒ½æ˜¯ä¸å¯è§çš„ã€‚**è¿™é‡Œçš„ä¸å¯è§æ˜¯æŒ‡åŸºç±»çš„ç§æœ‰æˆå‘˜è¿˜æ˜¯è¢«ç»§æ‰¿åˆ°äº†æ´¾ç”Ÿç±»å¯¹è±¡ä¸­ï¼Œä½†æ˜¯è¯­æ³•ä¸Šé™åˆ¶æ´¾ç”Ÿç±»å¯¹è±¡ä¸ç®¡åœ¨ç±»é‡Œé¢è¿˜æ˜¯ç±»å¤–é¢éƒ½ä¸èƒ½å»è®¿é—®å®ƒã€‚**
2. `protected`:åŸºç±»privateæˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­æ˜¯ä¸èƒ½è¢«è®¿é—®ï¼Œå¦‚æœåŸºç±»æˆå‘˜ä¸æƒ³åœ¨ç±»å¤–ç›´æ¥è¢«è®¿é—®ï¼Œä½†éœ€è¦åœ¨æ´¾ç”Ÿç±»ä¸­èƒ½è®¿é—®ï¼Œå°±å®šä¹‰ä¸ºprotectedã€‚**å¯ä»¥çœ‹å‡º`protected`ä¿æŠ¤æˆå‘˜é™å®šç¬¦æ˜¯å› ç»§æ‰¿æ‰å‡ºç°çš„ã€‚**
3. `è§„å¾‹`:å®é™…ä¸Šé¢çš„è¡¨æ ¼æˆ‘ä»¬è¿›è¡Œä¸€ä¸‹æ€»ç»“ä¼šå‘ç°ï¼ŒåŸºç±»çš„ç§æœ‰æˆå‘˜åœ¨å­ç±»éƒ½æ˜¯ä¸å¯è§ã€‚åŸºç±»çš„å…¶ä»–æˆå‘˜åœ¨å­ç±»çš„è®¿é—®æ–¹å¼ == `Min(æˆå‘˜åœ¨åŸºç±»çš„è®¿é—®é™å®šç¬¦ï¼Œç»§æ‰¿æ–¹å¼)`ï¼Œå…¶ä¸­çš„å¤§å°å…³ç³»ä¸º`public > protected > private`
4. `é»˜è®¤è¡Œä¸º`:ä½¿ç”¨å…³é”®å­—classæ—¶é»˜è®¤çš„ç»§æ‰¿æ–¹å¼æ˜¯privateï¼Œä½¿ç”¨structæ—¶é»˜è®¤çš„ç»§æ‰¿æ–¹å¼æ˜¯publicï¼Œä¸è¿‡**æœ€å¥½æ˜¾ç¤º**çš„å†™å‡ºç»§æ‰¿æ–¹å¼ã€‚
5. `æ‰©å±•æ€§`:åœ¨å®é™…è¿ç”¨ä¸­ä¸€èˆ¬ä½¿ç”¨éƒ½æ˜¯publicç»§æ‰¿ï¼Œå‡ ä¹å¾ˆå°‘ä½¿ç”¨protetced/privateç»§æ‰¿ï¼Œä¹Ÿä¸æå€¡ä½¿ç”¨protetced/privateç»§æ‰¿ï¼Œå› ä¸ºprotetced/privateç»§æ‰¿ä¸‹æ¥çš„æˆå‘˜éƒ½åªèƒ½åœ¨æ´¾ç”Ÿç±»çš„ç±»é‡Œé¢ä½¿ç”¨ï¼Œå®é™…ä¸­æ‰©å±•ç»´æŠ¤æ€§ä¸å¼º

## æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°
æœ‰æ—¶åŸºç±»å¹¶ä¸æä¾›æ— å‚çš„é»˜è®¤æ„é€ å‡½æ•°,é‚£ä¹ˆå¦‚ä½•åœ¨æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°é‡Œ`æ˜¾ç¤ºåœ°è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°`å‘¢?

å…¶å®ç¼–è¯‘å™¨çš„æŠ¥é”™ä¹Ÿç»™å‡ºäº†æç¤º

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/inherit_construct.png)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åˆå§‹åŒ–åˆ—è¡¨åé¢å‡ºç°äº†æŠ¥é”™:`Personä¸å­˜åœ¨é»˜è®¤æ„é€ å‡½æ•°`,æ˜¾ç„¶ï¼Œæ˜¾ç¤ºè°ƒç”¨æ„é€ å‡½æ•°çš„ä½ç½®åœ¨åˆå§‹åŒ–åˆ—è¡¨ã€‚

é‚£ä¹ˆæ€ä¹ˆè°ƒç”¨å‘¢ï¼Ÿæ„é€ å‡½æ•°ä¹Ÿæ˜¯æˆå‘˜å‡½æ•°ï¼é™¤äº†åŸºç±»ä¸­`private`ä¿®é¥°çš„æ„é€ å‡½æ•°ï¼Œæ´¾ç”Ÿç±»ä¸­çš†å¯è°ƒç”¨çˆ¶ç±»çš„æˆå‘˜å‡½æ•°ï¼Œç›´æ¥åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾å¼è°ƒç”¨å³å¯

```C++
#include <iostream>
#include <string>
using namespace std;

class Person
{
public:
	//åŸºç±»çš„å…¬æœ‰æ„é€ å‡½æ•°
	Person(const string& name, const string& gender, int age)
		:_name(name)
		,_gender(gender)
		,_age(age)
	{}
	void Info()
	{
		printf("name:%s age:%d\n", _name.c_str(), _age);
	}
protected:
	string _name;
	string _gender;
	int _age;
};

class Student :public Person
{
public:
	Student(const string& name,const string& gender,int age,int ID)
		:Person(name,gender,age)//æ˜¾å¼è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°
		,_ID(ID)
	{}
	void getID()
	{
		cout << "ID:" << _ID << endl;
	}
private:
	int _ID;
};


int main()
{
	Student stu("supdriver", "male", 24, 114514);//è°ƒç”¨æ„é€ å‡½æ•°
	return 0;
}
```

## åŸºç±»å’Œæ´¾ç”Ÿç±»çš„èµ‹å€¼è½¬åŒ–
+ æ´¾ç”Ÿç±»å¯¹è±¡ å¯ä»¥èµ‹å€¼ç»™ `åŸºç±»çš„å¯¹è±¡` / `åŸºç±»çš„æŒ‡é’ˆ` / `åŸºç±»çš„å¼•ç”¨`ã€‚è¿™é‡Œæœ‰ä¸ªå½¢è±¡çš„è¯´æ³•å«`åˆ‡ç‰‡`æˆ–è€…`åˆ‡å‰²`ã€‚å¯“æ„æŠŠæ´¾ç”Ÿç±»ä¸­çˆ¶ç±»é‚£éƒ¨åˆ†åˆ‡æ¥èµ‹å€¼è¿‡å»ã€‚
+ åŸºç±»å¯¹è±¡**ä¸èƒ½**èµ‹å€¼ç»™æ´¾ç”Ÿç±»å¯¹è±¡
+ åŸºç±»çš„`æŒ‡é’ˆ`æˆ–è€…`å¼•ç”¨`å¯ä»¥é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢èµ‹å€¼ç»™æ´¾ç”Ÿç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ã€‚ä½†æ˜¯å¿…é¡»æ˜¯**åŸºç±»çš„æŒ‡é’ˆæ˜¯æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡æ—¶æ‰æ˜¯å®‰å…¨çš„**ã€‚

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/slice.png)

ä¸‹é¢ç”¨ä¸€ä¸ªç¤ºä¾‹æ¼”ç¤ºä¸€ä¸‹åˆ‡ç‰‡,èµ‹å€¼è½¬æ¢ç­‰é—®é¢˜

```C++
#include <iostream>
#include <string>
using namespace std;

class Person
{
public:
	//åŸºç±»çš„å…¬æœ‰æ„é€ å‡½æ•°
	Person(const string& name, const string& gender, int age)
		:_name(name)
		,_gender(gender)
		,_age(age)
	{}
	void Info()
	{
		printf("name:%s age:%d\n", _name.c_str(), _age);
	}
protected:
	string _name;
	string _gender;
	int _age;
};

class Student :public Person
{
public:
	Student(const string& name,const string& gender,int age,int ID)
		:Person(name,gender,age)//æ˜¾å¼è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°
		,_ID(ID)
	{}
	void getID()
	{
		cout << "ID:" << _ID << endl;
	}
public:
	int _ID;
};


int main()
{
	Student stu("supdriver", "male", 24, 114514);//è°ƒç”¨æ„é€ å‡½æ•°

	Person  person(stu);//è¿™é‡Œæ²¡æœ‰æ˜¾å¼å£°æ˜å¯¹åº”çš„æ„é€ å‡½æ•°ï¼Œè€Œæ˜¯è‡ªåŠ¨åˆ‡ç‰‡
	Person* pp = &stu;//çˆ¶ç±»æŒ‡é’ˆå¯ä»¥æŒ‡å‘æ´¾ç”Ÿç±»
	Person& rp = stu;//çˆ¶ç±»å¼•ç”¨å¯ä»¥æŒ‡å‘æ´¾ç”Ÿç±»

	//stu = person;//çˆ¶ç±»å¯¹è±¡ä¸èƒ½èµ‹å€¼ç»™æ´¾ç”Ÿç±»

	//åŸºç±»çš„æŒ‡é’ˆå¯ä»¥é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢èµ‹å€¼ç»™æ´¾ç”Ÿç±»çš„æŒ‡é’ˆ
	pp = &stu;
	Student* pstu = (Student*)pp;//æŒ‡é’ˆåœ°å€å°±æ˜¯æŒ‡å‘æ´¾ç”Ÿç±»çš„ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µæ˜¯å®‰å…¨çš„ï¼Œåˆæ³•çš„
	pstu->_ID = 233;//è¿™é‡Œå¹¶æ²¡æœ‰è¶Šç•Œ

	pp = &person;
	pstu = (Student*)pp;//è¿™ç§å°±æ˜¯ä¸å®‰å…¨çš„ï¼Œå¯èƒ½ä¼šè¶Šç•Œè®¿é—®	
	return 0;
}
```

## ç»§æ‰¿ä¸­çš„ä½œç”¨åŸŸ(`éšè—`æœºåˆ¶)
1. åœ¨ç»§æ‰¿ä½“ç³»ä¸­`åŸºç±»`å’Œ`æ´¾ç”Ÿç±»`éƒ½æœ‰ç‹¬ç«‹çš„ä½œç”¨åŸŸ(`ç±»åŸŸ`)
2. å­ç±»å’Œçˆ¶ç±»ä¸­æœ‰åŒåæˆå‘˜ï¼Œ**ä¸æŒ‡å®šæˆå‘˜æ‰€åœ¨ç±»åŸŸæ—¶**ï¼Œå­ç±»æˆå‘˜å°†å±è”½çˆ¶ç±»å¯¹åŒåæˆå‘˜çš„ç›´æ¥è®¿é—®ï¼Œè¿™ç§æƒ…å†µå«`éšè—`ï¼Œä¹Ÿå«`é‡å®šä¹‰`ã€‚
3. éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœæ˜¯æˆå‘˜å‡½æ•°çš„éšè—ï¼Œåªéœ€è¦**å‡½æ•°åç›¸**åŒå°±æ„æˆéšè—ã€‚
4. æ³¨æ„åœ¨**å®é™…ä¸­**åœ¨ç»§æ‰¿ä½“ç³»é‡Œé¢æœ€å¥½**ä¸è¦å®šä¹‰åŒåçš„æˆå‘˜**ã€‚

```C++
#include <iostream>
#include <string>
using namespace std;

class Person
{
public:
	void Info()
	{
		printf("name:%s age:%d\n", _name.c_str(), _age);
	}
protected:
	string _name = "supdriver";
	int _age = 24;
};

class Student:public Person
{
public:
	void Info()//åŒåå‡½æ•°æ„æˆéšè—
	{
		printf("name:%s age:%d\n ID:%d", _name.c_str(), _age,_ID);
	}
private:
	int _ID = 114514;
};


int main()
{
	Student stu;
	stu.Info();//è°ƒç”¨Studentç±»å†…çš„Infoå‡½æ•°ï¼Œè€Œçˆ¶ç±»å†…çš„è¢«éšè—
	stu.Person::Info();//æ˜¾å¼è°ƒç”¨Personå†…çš„Infoå‡½æ•°
	return 0;
}
```

### éšè—ä¸é‡è½½è¾¨æ

+ `é‡è½½`ï¼šå‡½æ•°é‡è½½æ˜¯æ ¹æ®åŒåå‡½æ•°çš„`å‚æ•°ç±»å‹`å’Œ`å‚æ•°é¡ºåº`é€‰æ‹©å®é™…è°ƒç”¨çš„å‡½æ•°ï¼Œé€‰æ‹©çš„åŠ¨ä½œåªèƒ½ç”±ç¼–è¯‘å™¨å®Œæˆ
+ `éšè—`ï¼šæˆå‘˜çš„éšè—æ˜¯åŒåæˆå‘˜æ ¹æ®`ç±»åŸŸ`çš„`å°±è¿‘åŸåˆ™`ç”±ç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨ï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šç±»åŸŸï¼Œåœ¨ä»£ç ä¸­é€‰æ‹©

## æ´¾ç”Ÿç±»çš„é»˜è®¤æˆå‘˜å‡½æ•°
6ä¸ªé»˜è®¤æˆå‘˜å‡½æ•°ï¼Œâ€œé»˜è®¤"çš„æ„æ€å°±æ˜¯æŒ‡æˆ‘ä»¬ä¸å†™ï¼Œç¼–è¯‘å™¨ä¼šå˜æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªï¼Œé‚£ä¹ˆåœ¨æ´¾ç”Ÿç±»
ä¸­ï¼Œè¿™å‡ ä¸ªæˆå‘˜å‡½æ•°æ˜¯å¦‚ä½•ç”Ÿæˆçš„å‘¢?

1. æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°åˆå§‹åŒ–åŸºç±»çš„é‚£ä¸€éƒ¨åˆ†æˆå‘˜ã€‚å¦‚æœåŸºç±»æ²¡æœ‰é»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œåˆ™å¿…é¡»åœ¨æ´¾ç”Ÿç±»æ„é€ å‡½æ•°çš„åˆå§‹åŒ–åˆ—è¡¨é˜¶æ®µæ˜¾ç¤ºè°ƒç”¨ã€‚
2. æ´¾ç”Ÿç±»çš„æ‹·è´æ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨åŸºç±»çš„æ‹·è´æ„é€ å®ŒæˆåŸºç±»çš„æ‹·è´åˆå§‹åŒ–ã€‚
3. æ´¾ç”Ÿç±»çš„operator=å¿…é¡»è¦è°ƒç”¨åŸºç±»çš„operator=å®ŒæˆåŸºç±»çš„å¤åˆ¶ã€‚
4. æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ä¼šåœ¨è¢«è°ƒç”¨å®Œæˆåè‡ªåŠ¨è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°æ¸…ç†åŸºç±»æˆå‘˜ã€‚å› ä¸ºè¿™æ ·æ‰èƒ½ä¿è¯æ´¾ç”Ÿç±»å¯¹è±¡å…ˆæ¸…ç†æ´¾ç”Ÿç±»æˆå‘˜å†æ¸…ç†åŸºç±»æˆå‘˜çš„é¡ºåºã€‚
5. æ´¾ç”Ÿç±»å¯¹è±¡åˆå§‹åŒ–å…ˆè°ƒç”¨åŸºç±»æ„é€ å†è°ƒæ´¾ç”Ÿç±»æ„é€ ã€‚
6. æ´¾ç”Ÿç±»å¯¹è±¡ææ„æ¸…ç†å…ˆè°ƒç”¨æ´¾ç”Ÿç±»ææ„å†è°ƒåŸºç±»çš„ææ„ã€‚
7. å› ä¸ºåç»­ä¸€äº›åœºæ™¯ææ„å‡½æ•°éœ€è¦æ„æˆé‡å†™ï¼Œé‡å†™çš„æ¡ä»¶ä¹‹ä¸€æ˜¯å‡½æ•°åç›¸åŒ(è¿™ä¸ªæˆ‘ä»¬åé¢ä¼šè®²è§£)ã€‚é‚£ä¹ˆç¼–è¯‘å™¨ä¼šå¯¹**ææ„å‡½æ•°åè¿›è¡Œç‰¹æ®Šå¤„ç†**ï¼Œå¤„ç†æˆ`destrutor()`ï¼Œæ‰€ä»¥çˆ¶ç±»ææ„å‡½æ•°ä¸åŠ virtualçš„æƒ…å†µä¸‹ï¼Œå­ç±»ææ„å‡½æ•°å’Œçˆ¶ç±»ææ„å‡½æ•°æ„æˆéšè—å…³ç³»ã€‚

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/202409031848644.png)

## ç»§æ‰¿ä¸å‹å…ƒå‡½æ•°
å‹å…ƒå…³ç³»ä¸èƒ½ç»§æ‰¿ï¼Œä¹Ÿå°±æ˜¯è¯´åŸºç±»å‹å…ƒä¸èƒ½è®¿é—®å­ç±»ç§æœ‰å’Œä¿æŠ¤æˆå‘˜ 

ç¤ºä¾‹å¦‚ä¸‹
```C++
#include <iostream>
#include <string>
using namespace std;

class Student;
class Person
{
public:
	friend void Display(const Person& p, const Student& s);
protected:
	string _name; // å§“å
};
class Student : public Person
{
protected:
	int _stuNum; // å­¦å·
};

void Display(const Person& p, const Student& s)
{
	cout << p._name << endl;
	cout << s._name << endl;//è¿™è¡Œä»£ç ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸º_nameæ˜¯ç»§æ‰¿è‡ªPersonç±»çš„
	cout << s._stuNum << endl;//è¿™è¡Œä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºå‡½æ•°æ²¡æœ‰æƒé™è®¿é—®Studentç±»è‡ªå·±å£°æ˜çš„æˆå‘˜
}
void main()
{
	Person p;
	Student s;
	Display(p, s);
}
```

## ç»§æ‰¿ä¸é™æ€æˆå‘˜
åŸºç±»å®šä¹‰äº†`staticé™æ€æˆå‘˜`ï¼Œåˆ™**æ•´ä¸ªç»§æ‰¿ä½“ç³»é‡Œé¢åªæœ‰ä¸€ä¸ªè¿™æ ·çš„æˆå‘˜**ã€‚æ— è®ºæ´¾ç”Ÿå‡ºå¤šå°‘ä¸ªå­ç±»ï¼Œéƒ½**åªæœ‰ä¸€ä¸ª**staticæˆå‘˜å®ä¾‹ ã€‚


```C++
#include <iostream>
#include <string>
using namespace std;

class Person
{
public:
	Person() { ++_count; }
protected:
	string _name; // å§“å
public:
	static int _count; // é™æ€æˆå‘˜å˜é‡,ç»Ÿè®¡äººçš„ä¸ªæ•°ã€‚
};
int Person::_count = 0;

class Student : public Person
{
protected:
	int _stuNum; // å­¦å·
};
class Graduate : public Student
{
protected:
	string _seminarCourse; // ç ”ç©¶ç§‘ç›®
};
int main()
{
	Student s1;
	Student s2;
	Student s3;
	Graduate s4;
	cout << " äººæ•° :" << Person::_count << endl;
	Student::_count = 0;
	cout << " äººæ•° :" << Person::_count << endl;
	return 0;
}
```
ç»“æœå¦‚ä¸‹

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/202409040748921.png)

## å¤æ‚çš„è±å½¢ç»§æ‰¿åŠè±å½¢è™šæ‹Ÿç»§æ‰¿

### å•ç»§æ‰¿

`å•ç»§æ‰¿`ï¼šä¸€ä¸ªå­ç±»åªæœ‰*ä¸€ä¸ªç›´æ¥çˆ¶ç±»*æ—¶ç§°è¿™ä¸ªç»§æ‰¿å…³ç³»ä¸º`å•ç»§æ‰¿`

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/single_inherit.png)

### å¤šç»§æ‰¿

`å¤šç»§æ‰¿`ï¼šä¸€ä¸ªå­ç±»æœ‰**ä¸¤ä¸ªæˆ–ä»¥ä¸Šç›´æ¥çˆ¶ç±»**æ—¶ç§°è¿™ä¸ªç»§æ‰¿å…³ç³»ä¸º`å¤šç»§æ‰¿`

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/multi_inherit.png)

### è±å½¢ç»§æ‰¿

`è±å½¢ç»§æ‰¿`ï¼šè±å½¢ç»§æ‰¿æ˜¯å¤šç»§æ‰¿çš„ä¸€ç§**ç‰¹æ®Šæƒ…å†µ**ã€‚

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/Diamond_Inherit.png)

`è±å½¢ç»§æ‰¿çš„é—®é¢˜`ï¼šä»ä¸‹é¢çš„å¯¹è±¡æˆå‘˜æ¨¡å‹æ„é€ ï¼Œå¯ä»¥çœ‹å‡ºè±å½¢ç»§æ‰¿æœ‰`æ•°æ®å†—ä½™`å’Œ`äºŒä¹‰æ€§`çš„é—®é¢˜ã€‚
åœ¨Assistantçš„å¯¹è±¡ä¸­Personæˆå‘˜ä¼šæœ‰ä¸¤ä»½ã€‚

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/IHR_diamond.png)

```C++
class Person
{
public :
 	string _name ; // å§“å
};
class Student : public Person
{
protected :
 	int _num ; //å­¦å·
};
class Teacher : public Person
{
protected :
 	int _id ; // èŒå·¥ç¼–å·
};
class Assistant : public Student, public Teacher
{
protected :
 	string _majorCourse ; // ä¸»ä¿®è¯¾ç¨‹
};
void Test ()
{
	// è¿™æ ·ä¼šæœ‰äºŒä¹‰æ€§æ— æ³•æ˜ç¡®çŸ¥é“è®¿é—®çš„æ˜¯å“ªä¸€ä¸ª
	Assistant a ;
	a._name = "peter";
	// éœ€è¦æ˜¾ç¤ºæŒ‡å®šè®¿é—®å“ªä¸ªçˆ¶ç±»çš„æˆå‘˜å¯ä»¥è§£å†³äºŒä¹‰æ€§é—®é¢˜ï¼Œä½†æ˜¯æ•°æ®å†—ä½™é—®é¢˜æ— æ³•è§£å†³
	a.Student::_name = "xxx";
	a.Teacher::_name = "yyy";
}
```

####  è™šæ‹Ÿç»§æ‰¿ 
`è™šæ‹Ÿç»§æ‰¿`å¯ä»¥è§£å†³**è±å½¢ç»§æ‰¿**çš„äºŒä¹‰æ€§å’Œæ•°æ®å†—ä½™çš„é—®é¢˜ã€‚å¦‚ä¸Šé¢çš„ç»§æ‰¿å…³ç³»ï¼Œåœ¨Studentå’ŒTeacherçš„ç»§æ‰¿Personæ—¶ä½¿ç”¨`è™šæ‹Ÿç»§æ‰¿`ï¼Œå³å¯è§£å†³é—®é¢˜ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ**è™šæ‹Ÿç»§æ‰¿ä¸è¦åœ¨å…¶ä»–åœ°æ–¹å»ä½¿ç”¨ã€‚**

```C++
class Person
{
public :
 	string _name ; // å§“å
};
class Student : virtual public Person //è™šæ‹Ÿç»§æ‰¿å…±åŒçˆ¶ç±»
{
protected :
 	int _num ; //å­¦å·
};
class Teacher : virtual public Person //è™šæ‹Ÿç»§æ‰¿å…±åŒçˆ¶ç±»
{
protected :
 	int _id ; // èŒå·¥ç¼–å·
};
class Assistant : public Student, public Teacher
{
protected :
 	string _majorCourse ; // ä¸»ä¿®è¯¾ç¨‹
};
void Test ()
{
 	Assistant a ;
 	a._name = "peter";//äºŒä¹‰æ€§å’Œæ•°æ®å†—ä½™å·²è¢«è§£å†³
}
```

**è™šæ‹Ÿç»§æ‰¿è§£å†³æ•°æ®å†—ä½™å’ŒäºŒä¹‰æ€§çš„åŸç†**
ä¸‹å›¾æ˜¯è±å½¢è™šæ‹Ÿç»§æ‰¿çš„å†…å­˜å¯¹è±¡æˆå‘˜æ¨¡å‹ï¼šè¿™é‡Œå¯ä»¥åˆ†æå‡º`Assistant`å¯¹è±¡ä¸­å°†`Person`æ”¾åˆ°çš„äº†å¯¹è±¡ç»„æˆçš„æœ€ä¸‹é¢ï¼Œè¿™ä¸ª`Person`åŒæ—¶å±äº`Student`å’Œ`Teacher`ï¼Œé‚£ä¹ˆ`Student`å’Œ`Teacher`å¦‚ä½•å»æ‰¾åˆ°å…¬å…±çš„`Person`å‘¢ï¼Ÿ**è¿™é‡Œæ˜¯é€šè¿‡äº†`Student`å’Œ`Teacher`çš„ä¸¤ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘çš„ä¸€å¼ è¡¨ã€‚è¿™ä¸¤ä¸ªæŒ‡é’ˆå«`è™šåŸºè¡¨æŒ‡é’ˆ`ï¼Œè¿™ä¸¤ä¸ªè¡¨å«`è™šåŸºè¡¨`ã€‚è™šåŸºè¡¨ä¸­å­˜çš„åç§»é‡ã€‚é€šè¿‡åç§»é‡å¯ä»¥æ‰¾åˆ°ä¸‹é¢çš„`Person`**

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/INHERIT_virtual.png)

# ç»§æ‰¿çš„æ€»ç»“å’Œåæ€

## å°½é‡ä¸ä½¿ç”¨å¤šç»§æ‰¿ï¼Œä¸è¦è®¾è®¡å‡ºè±å½¢ç»§æ‰¿
C++è¯­æ³•ä¸­çš„`å¤šç»§æ‰¿`æ­£æ˜¯å…¶è¯­æ³•å¤æ‚æ€§çš„ä½“ç°ä¹‹ä¸€ã€‚æœ‰äº†å¤šç»§æ‰¿ï¼Œå°±å­˜åœ¨è±å½¢ç»§æ‰¿ï¼Œæœ‰äº†è±å½¢ç»§æ‰¿å°±æœ‰è±å½¢è™šæ‹Ÿç»§æ‰¿ï¼Œåº•å±‚å®ç°å°±å¾ˆå¤æ‚ã€‚æ‰€ä»¥**ä¸€èˆ¬ä¸å»ºè®®è®¾è®¡å‡ºå¤šç»§æ‰¿ï¼Œä¸€å®šä¸è¦è®¾è®¡å‡ºè±å½¢ç»§æ‰¿**ã€‚å¦åˆ™åœ¨å¤æ‚åº¦åŠæ€§èƒ½ä¸Šéƒ½æœ‰é—®é¢˜ã€‚

## ç»§æ‰¿å’Œç»„æˆè¾¨æ
+ publicç»§æ‰¿æ˜¯ä¸€ç§`is-a`çš„å…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªåŸºç±»å¯¹è±¡
+ ç»„åˆæ˜¯ä¸€ç§`has-a`çš„å…³ç³»ã€‚å‡è®¾Bç»„åˆäº†Aï¼Œæ¯ä¸ªBå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ªAå¯¹è±¡ã€‚
+ ä¸ºäº†æé«˜ä»£ç çš„`å°è£…æ€§`å’Œ`è§£è€¦åˆ`ï¼Œ[ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œè€Œä¸æ˜¯ç±»ç»§æ‰¿ğŸ”—](https://www.cnblogs.com/nexiyi/archive/2013/06/16/3138568.html)
+ `ç™½ç®±å¤ç”¨`ï¼šç»§æ‰¿å…è®¸ä½ æ ¹æ®åŸºç±»çš„å®ç°æ¥å®šä¹‰æ´¾ç”Ÿç±»çš„å®ç°ã€‚è¿™ç§é€šè¿‡ç”Ÿæˆæ´¾ç”Ÿç±»çš„å¤ç”¨é€šå¸¸è¢«ç§°ä¸ºç™½ç®±å¤ç”¨(white-box reuse)ã€‚æœ¯è¯­â€œç™½ç®±â€æ˜¯ç›¸å¯¹å¯è§†æ€§è€Œè¨€ï¼šåœ¨ç»§æ‰¿æ–¹å¼ä¸­ï¼Œ**åŸºç±»çš„å†…éƒ¨ç»†èŠ‚å¯¹å­ç±»å¯è§** ã€‚ç»§æ‰¿ä¸€å®šç¨‹åº¦**ç ´å**äº†åŸºç±»çš„å°è£…ï¼ŒåŸºç±»çš„æ”¹å˜ï¼Œå¯¹æ´¾ç”Ÿç±»æœ‰å¾ˆå¤§çš„å½±å“ã€‚æ´¾ç”Ÿç±»å’ŒåŸºç±»é—´çš„ä¾èµ–å…³ç³»å¾ˆå¼ºï¼Œ**è€¦åˆåº¦é«˜**ã€‚
+ `é»‘ç®±å¤ç”¨`ï¼šå¯¹è±¡ç»„åˆæ˜¯ç±»ç»§æ‰¿ä¹‹å¤–çš„å¦ä¸€ç§å¤ç”¨é€‰æ‹©ã€‚æ–°çš„æ›´å¤æ‚çš„åŠŸèƒ½å¯ä»¥é€šè¿‡ç»„è£…æˆ–ç»„åˆå¯¹è±¡æ¥è·å¾—ã€‚å¯¹è±¡ç»„åˆè¦æ±‚è¢«ç»„åˆçš„å¯¹è±¡å…·æœ‰è‰¯å¥½å®šä¹‰çš„æ¥å£ã€‚è¿™ç§å¤ç”¨é£æ ¼è¢«ç§°ä¸ºé»‘ç®±å¤ç”¨(black-box reuse)ï¼Œå› ä¸ºå¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚æ˜¯ä¸å¯è§çš„ã€‚å¯¹è±¡åªä»¥â€œé»‘ç®±â€çš„å½¢å¼å‡ºç°ã€‚ç»„åˆç±»ä¹‹é—´æ²¡æœ‰å¾ˆå¼ºçš„ä¾èµ–å…³ç³»ï¼Œè€¦åˆåº¦ä½ã€‚ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆæœ‰åŠ©äºä½ ä¿æŒæ¯ä¸ªç±»è¢«å°è£…ã€‚
+ å®é™…å°½é‡å¤šå»ç”¨ç»„åˆã€‚ç»„åˆçš„è€¦åˆåº¦ä½ï¼Œä»£ç ç»´æŠ¤æ€§å¥½ã€‚ä¸è¿‡ç»§æ‰¿ä¹Ÿæœ‰ç”¨æ­¦ä¹‹åœ°çš„ï¼Œæœ‰äº›å…³ç³»å°±é€‚åˆç»§æ‰¿é‚£å°±ç”¨ç»§æ‰¿ï¼Œå¦å¤–è¦å®ç°å¤šæ€ï¼Œä¹Ÿå¿…é¡»è¦ç»§æ‰¿ã€‚ç±»ä¹‹é—´çš„å…³ç³»å¯ä»¥ç”¨ç»§æ‰¿ï¼Œå¯ä»¥ç”¨ç»„åˆï¼Œå°±ç”¨ç»„åˆã€‚