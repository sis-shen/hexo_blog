---
title: ã€pythoné¡¹ç›®å®è·µã€‘ACVAèˆªç©ºå…¬å¸å®¢æˆ·ä»·å€¼åˆ†æ
date: 2024-09-03 09:38:54
tags:
cover: https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_COVER.png
---
# èƒŒæ™¯åˆ†æ

## èˆªç©ºå…¬å¸ç°çŠ¶

#### è¡Œä¸šå†…ç«äº‰
æ°‘èˆªçš„ç«äº‰é™¤äº†ä¸‰å¤§èˆªç©ºå…¬å¸ä¹‹é—´çš„ç«äº‰å¤–ï¼Œè¿˜å°†åŠ å…¥æ–°å´›èµ·çš„å„ç±»å°å‹èˆªç©ºå…¬å¸ã€æ°‘è¥èˆªç©ºå…¬å¸ï¼Œç”šè‡³å›½å¤–èˆªç©ºå·¨å¤´ã€‚èˆªç©ºäº§å“**ç”Ÿäº§è¿‡å‰©,äº§å“åŒè´¨åŒ–**ç‰¹å¾æ„ˆåŠ æ˜æ˜¾ï¼Œäºæ˜¯èˆªç©ºå…¬å¸ä»**ä»·æ ¼ã€æœåŠ¡**é—´çš„ç«äº‰é€æ¸è½¬å‘å¯¹**å®¢æˆ·**çš„ç«äº‰

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/airliness.png)

## è¡Œä¸šå¤–ç«äº‰
éšç€**é«˜é“**ã€åŠ¨è½¦ç­‰é“è·¯è¿è¾“çš„å…´å»ºï¼Œèˆªç©ºå…¬å¸å—åˆ°å·¨å¤§å†²å‡»

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/transportalrad.png)

*å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç»è¿‡2010åˆ°2015å¹´çš„å‘å±•ï¼Œé“è·¯è¿è¾“å¯¹èˆªç©ºè¿è¾“çš„å†²å‡»è¶Šå‘æ˜æ˜¾*

## èˆªç©ºå…¬å¸æ•°æ®ç‰¹å¾è¯´æ˜
+ ç›®å‰èˆªç©ºå…¬å¸å·²ç»ç§¯ç´¯äº†å¤§é‡çš„ä¼šå‘˜æ¡£æ¡ˆä¿¡æ¯å’Œå…¶ä¹˜åèˆªç­è®°å½•
+ å°±æœ¬é¡¹ç›®å·²è·å–çš„æ•°æ®ï¼Œä»¥2014-03-31ä¸ºç»“æŸæ—¶é—´ï¼Œé€‰å–å®½åº¦ä¸º**ä¸¤å¹´**çš„æ—¶é—´æ®µä½œä¸ºåˆ†æè§‚æµ‹çª—å£ï¼ŒæŠ½å–è§‚æµ‹çª—å£å†…æœ‰ä¹˜æœºè®°å½•çš„æ‰€æœ‰å®¢æˆ·çš„è¯¦ç»†æ•°æ®å½¢æˆçš„å†å²æ•°æ®ï¼Œ44ä¸ªç‰¹å¾ï¼Œæ€»å…±62988æ¡è®°å½•ã€‚
 
æ•°æ®ç‰¹å¾è®°å½•è¯´æ˜å¦‚ä¸‹è¡¨æ‰€ç¤º:

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_TABLE1.png)
![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_TABLE2.png)
![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_TABLE3.png)

## ç»“åˆæ•°æ®çš„é¡¹ç›®ç›®æ ‡
ç»“åˆç›®å‰èˆªç©ºå…¬å¸çš„æ•°æ®æƒ…å†µï¼Œå¯ä»¥å®ç°ä»¥ä¸‹ç›®æ ‡

+ å€ŸåŠ©èˆªç©ºå…¬å¸å®¢æˆ·æ•°æ®ï¼Œå¯¹å®¢æˆ·è¿›è¡Œåˆ†ç±»
+ å¯¹ä¸åŒçš„å®¢æˆ·ç±»åˆ«`è¿›è¡Œç‰¹å¾åˆ†æ`ï¼Œæ¯”è¾ƒä¸åŒç±»åˆ«å®¢æˆ·çš„`å®¢æˆ·ä»·å€¼`
+ å¯¹ä¸åŒä»·å€¼çš„å®¢æˆ·ç±»åˆ«æä¾›`ä¸ªæ€§åŒ–æœåŠ¡`,åˆ¶å®šç›¸åº”çš„`è¥é”€ç­–ç•¥`

## äº†è§£å®¢æˆ·ä»·å€¼åˆ†æ
å®¢æˆ·è¥é”€æˆ˜ç•¥å€¡å¯¼è€…*Jay* & *Adam Curry* ä»å›½å¤–æ•°ç™¾å®¶å…¬å¸è¿›è¡Œäº†å®¢æˆ·è¥é”€å®æ–½çš„ç»éªŒä¸­æç‚¼äº†å¦‚ä¸‹ç»éªŒ

+ å…¬å¸**æ”¶å…¥**çš„`80%`æ¥è‡ªé¡¶ç«¯çš„`20%`å®¢æˆ·
+ `20%`çš„å®¢æˆ·å…¶åˆ©`æ¶¦ç‡100%`
+ `90%`ä»¥ä¸Šçš„æ”¶å…¥æ¥è‡ª**ç°æœ‰**å®¢æˆ·
+ **å¤§éƒ¨åˆ†çš„è¥é”€é¢„ç®—**ç»å¸¸è¢«ç”¨åœ¨éç°æœ‰å®¢æˆ·ä¸Š
+ `5%`è‡³`30%`çš„å®¢æˆ·åœ¨å®¢æˆ·é‡‘å­—å¡”ä¸­å…·æœ‰**å‡çº§æ½œåŠ›**
+ å®¢æˆ·é‡‘å­—å¡”ä¸­å®¢æˆ·å‡çº§`2%`ï¼Œæ„å‘³ç€è¥é”€æ”¶å…¥å¢åŠ `10%`,åˆ©æ¶¦å¢åŠ `50%`

ä¹Ÿè®¸è¿™äº›ç»éªŒå¹¶ä¸å®Œå…¨å‡†ç¡®ï¼Œä½†æ˜¯å®ƒè§£é‡Šäº†æ–°æ—¶ä»£`å®¢æˆ·åˆ†åŒ–`çš„è¶‹åŠ¿ï¼Œä¹Ÿè¯´æ˜äº†å¯¹å®¢æˆ·ä»·å€¼åˆ†æçš„**è¿«åˆ‡æ€§**å’Œ**å¿…è¦æ€§**

## é¡¹ç›®æµç¨‹å›¾
![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_flow_char.png)

# ä»£ç å®ç°ä¸šåŠ¡åŠŸèƒ½

## ç³»ç»Ÿæ¶æ„

### æ–‡ä»¶ç»“æ„
è¿™é‡Œä¸»è¦ç”¨ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«å‚¨å­˜`ä»£ç `ï¼Œ`åŸå§‹æ•°æ®`,`ä¸´æ—¶æ–‡ä»¶`

+ `codes`       ä»£ç æ–‡ä»¶å¤¹
+ `data_raw`    åŸå§‹æ•°æ®æ–‡ä»¶å¤¹
+ `tmp`         ä¸´æ—¶æ–‡ä»¶æ–‡ä»¶å¤¹

## ä»£ç ç»“æ„

æœ¬ä¸šåŠ¡ç³»ç»Ÿé‡‡ç”¨ä¸€ä¸ª`main.py`æ‰§è¡Œä¸»è¦ä¸šåŠ¡é€»è¾‘ï¼Œå°è£…å¤šä¸ªæ¨¡å—å’Œç±»å®ç°å…·ä½“ä¸šåŠ¡ï¼Œä»¥è¾¾åˆ°ä¸»è¦ä¸šåŠ¡é€»è¾‘æ¸…æ™°ï¼Œä»£ç å°è£…æ€§å¼ºï¼Œæ˜“äºç»´æŠ¤å’Œå¤ç”¨çš„ä¼˜ç‚¹

ä¸»è¦çš„ä»£ç æ–‡ä»¶æœ‰:

+ main.py       æ‰§è¡Œä¸»è¦é€»è¾‘
+ log.py        æä¾›æ—¥å¿—å™¨
+ data_cleaner  å®ç°æ¸…æ´—æ•°æ®
+ LEDNX.py      æ„å»ºå’Œæå–äº”å¤§ç‰¹å¾
+ radar_char.py ç»˜åˆ¶ç»“æœé›·è¾¾å›¾

## å®ç°ä¸€ä¸ªç®€å•çš„æ—¥å¿—å™¨
ä¸€èˆ¬æ—¥å¿—å™¨æœ‰`æ—¥å¿—ç­‰çº§`ï¼Œ`æ—¥å¿—æ—¶é—´`ï¼Œå’Œ`æ—¥å¿—å†…å®¹`ä¸‰å¤§éƒ¨åˆ†ï¼Œä¸è¿‡æœ¬æ¬¡ä¸šåŠ¡ä¸æ—¶é—´å…³è”æ€§ä¸å¤§ï¼Œå°±åªæ‰“å°ä¸¤ä¸ªéƒ¨åˆ†

> log.py
```Python
###### å®ç°æ—¥å¿—ç³»ç»Ÿ ########

# å®šä¹‰æ—¥å¿—ç­‰çº§
LOG_INFO = "Info"
LOG_ERROR = "Error"
LOG_WANING = "Warning"
LOG_FATAL = "Fatal"

class Log:
    def __init__(self):
        return

    def __call__(self,level,*msgs): # é‡è½½()è¿ç®—ç¬¦
        print("[", level, "]",end='')
        for msg in msgs:
            print(msg)
        # æœ¬é¡¹ç›®ä¸æ—¶é—´å…³ç³»ä¸å¤§ï¼Œæ—¥å¿—ç³»ç»Ÿä¸æ‰“å°æ—¶é—´
```

è¿™é‡Œä½¿ç”¨äº†`__call__`å¯¹`()`æ“ä½œç¬¦çš„`é‡è½½`ï¼Œå’Œ`*mgs`è¾¾åˆ°äº†`ä¼ é€’ä»»æ„æ•°é‡å‚æ•°`çš„è¯­æ³•ç‰¹æ€§

è¿™æ ·ä»¥åæ‰“å°æ—¥å¿—å¯ä»¥æ–¹ä¾¿åœ°æŠŠå¯¹è±¡å½“å‡½æ•°ç”¨

## ç¨‹åºå…¥å£ & ä»æ•°æ®æºæå–æ•°æ®
æˆ‘ä»¬å°†`main.py`ä½œä¸ºé¡¹ç›®çš„ç¨‹åºå…¥å£

> main.py
```Python
######### ä¸»ç¨‹åºå…¥å£ #############
import numpy as np
import pandas as pd
from sklearn.cluster import KMeans
import time

from log import *
from data_clean import *
from LRFMC import *

if __name__ == '__main__':

    log = Log()  # å®ä¾‹åŒ–ä¸€ä¸ªæ—¥å¿—å™¨
    data_cleaner = DataCleaner() #å®ä¾‹åŒ–æ•°æ®æ¸…æ´—å™¨
    LRFMCobj = LRFMC()  # å®ä¾‹åŒ–æ¨¡å‹å¤„ç†å™¨
```

è¿™é‡Œçš„æ•°æ®æºä¸º`.csv`æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨åˆ°`pandas`æ¨¡å—è¯»å–æ–‡ä»¶åˆ°è¡¨æ ¼ä¸­

è¿™é‡Œä»£ç ä¸å¤šï¼Œå°±ç›´æ¥å†™åœ¨`main.py`é‡Œäº†

```Python
    # ...ä¸Šç•¥...
    #data_cleaner = DataCleaner() #å®ä¾‹åŒ–æ•°æ®æ¸…æ´—å™¨

    # ä»æ•°æ®æºè·å–æ•°æ®
    airline_data = pd.read_csv("../data_raw/air_data.csv",
        encoding="gb18030")  # å¯¼å…¥èˆªç©ºæ•°æ®
    log(LOG_INFO,'åŸå§‹æ•°æ®çš„å½¢çŠ¶ä¸ºï¼š', airline_data.shape)

```

## é¢„å¤„ç†èˆªç©ºå…¬å¸æ•°æ®
èˆªç©ºå…¬å¸å®¢æˆ·åŸå§‹æ•°æ®å­˜åœ¨å°‘é‡çš„`ç¼ºå¤±å€¼`å’Œ`å¼‚å¸¸å€¼`ï¼Œéœ€è¦æ¸…æ´—åæ‰èƒ½ç”¨äºåˆ†æã€‚

### ç¼ºå¤±å€¼å¤„ç†
é€šè¿‡å¯¹æ•°æ®è§‚å¯Ÿå‘ç°åŸå§‹æ•°æ®ä¸­å­˜åœ¨ç¥¨ä»·ä¸ºç©ºå€¼ï¼Œç¥¨ä»·æœ€å°å€¼ä¸º0ï¼ŒæŠ˜æ‰£ç‡æœ€å°å€¼ä¸º0ï¼Œæ€»é£è¡Œå…¬é‡Œæ•°å¤§äº0çš„è®°å½•ã€‚ç¥¨ä»·ä¸ºç©ºå€¼çš„æ•°æ®å¯èƒ½æ˜¯å®¢æˆ·ä¸å­˜åœ¨ä¹˜æœºè®°å½•é€ æˆã€‚

å¤„ç†æ–¹æ³•ï¼šä¸¢å¼ƒç¥¨ä»·ä¸ºç©ºçš„è®°å½•

å…·ä½“å®ç°ï¼š è€ƒè™‘åˆ°ä¸ç¥¨ä»·æœ‰å…³çš„ç‰¹å¾æœ‰`SUM_YR_1`å’Œ`SUM_YR_2`ä¸¤æ¡ï¼Œé€»è¾‘ä¸Šä¸¤æ¡ç‰¹å¾æ•°æ®éƒ½ä¸º`0`æ‰ç®—`ç¼ºå¤±å€¼`,æ‰€ä»¥åˆ†åˆ«æå–ä¸¤æ¡å¯¹åº”çš„`å¸ƒå°”å€¼åˆ—è¡¨`ï¼Œå¹¶ç”¨`é€»è¾‘ä¸`åˆå¹¶ï¼Œç”¨äºæ•°æ®è¡¨æ ¼çš„åˆ‡ç‰‡

*æˆ‘ä»¬å…ˆå®šä¹‰å¥½æˆå‘˜å‡½æ•°ï¼Œæœ€åå°è£…åˆ°DataCleanerç±»ä¸­*
> data_cleaner.py
```Python
    def notNull(self,airline_data):  # ç¼ºå¤±å€¼å¤„ç†ï¼šå»é™¤ç¥¨ä»·ä¸ºç©ºçš„è®°å½•
        exp1 = airline_data["SUM_YR_1"].notnull()
        exp2 = airline_data["SUM_YR_2"].notnull()
        exp = exp1 & exp2  # æŒ‰ä½é€»è¾‘ä¸,è·å–æ‰€éœ€çš„å¸ƒå°”å€¼åˆ—è¡¨
        # airline_notnull = airline_data.loc[exp, :]  # expæä¾›å¸ƒå°”å€¼ç«–åˆ—è¡¨ï¼Œ ':'é»˜è®¤æ— å‚æ—¶ï¼Œåˆ‡ç‰‡æ‰€æœ‰è¡Œ,å®Œæˆå»é™¤æ“ä½œ
        airline_notnull = airline_data[exp] #  è¿™æ˜¯ä¸Šä¸€å¥çš„ç®€åŒ–å†™æ³•ï¼ˆä½¿ç”¨æ›´å¤šçš„ç¼ºçœå‚æ•°

        return airline_notnull
```

### å¼‚å¸¸å€¼

å…¶ä»–çš„æ•°æ®å¯èƒ½æ˜¯å®¢æˆ·ä¹˜å`0æŠ˜æœºç¥¨`æˆ–è€…`ç§¯åˆ†å…‘æ¢`é€ æˆã€‚ç”±äºåŸå§‹æ•°æ®é‡å¤§ï¼Œè¿™ç±»æ•°æ®æ‰€å æ¯”ä¾‹è¾ƒå°ï¼Œå¯¹äºé—®é¢˜å½±å“ä¸å¤§ï¼Œå› æ­¤å¯¹å…¶è¿›è¡Œä¸¢å¼ƒå¤„ç†ã€‚

å¤„ç†æ–¹æ³•ï¼šä¸¢å¼ƒ**ç¥¨ä»·ä¸º0ï¼Œå¹³å‡æŠ˜æ‰£ç‡ä¸º0ï¼Œæ€»é£è¡Œå…¬é‡Œæ•°å¤§äº0çš„è®°å½•ã€‚**

å…·ä½“å¤„ç†ï¼šé‡‡ç”¨`index1`å’Œ`index2`å…ˆä¿ç•™æ€»ç¥¨ä»·ä¸ä¸º`0`çš„è®°å½•,ç„¶åç”¨`index3`ç­›é€‰å‡ºæ€»é‡Œç¨‹`SEG_KM_SUM``>0`ä¸”å¹³å‡æŠ˜æ‰£ç‡`avg_discount``!=0`çš„è®°å½•,ä½¿ç”¨å¸ƒå°”å€¼åˆ—è¡¨`(index1 | index2) & index3`è¿›è¡Œç­›é€‰ï¼Œä¿ç•™æ‰€éœ€æ•°æ®

```Python
    def notOutlier(self,airline_data):
        index1 = airline_data["SUM_YR_1"].notnull()
        index2 = airline_data["SUM_YR_2"] != 0  # æ•ˆæœå’Œä¸Šä¸€å¥çš„notnull()ä¸€æ ·,éƒ½æ˜¯ç”Ÿæˆbool array
        index3 = (airline_data["SEG_KM_SUM"] > 0) & \
                 (airline_data["avg_discount"] != 0)  # æŠ˜æ‰£ä¸”æ€»é‡Œç¨‹ä¸ä¸º0çš„æœºç¥¨
        airline = airline_data[(index1 | index2) & index3]  # ä¸¢å¼ƒç¥¨ä»·ä¸º0ï¼Œæˆ–æŠ˜æ‰£ç‡ä¸º0ï¼Œä¸”æ€»é‡Œç¨‹>0çš„å¼‚å¸¸å€¼
        return airline
```

### å°è£…DataCleanerç±»
å°†ç”¨äºæ¸…ç†æ•°æ®çš„å‡½æ•°æ•´åˆåˆ°ä¸€ä¸ªç±»ä¸­ï¼Œæ–¹ä¾¿ç»´æŠ¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹æ–°çš„æ¸…ç†è§„åˆ™ä¹Ÿå¾ˆå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰¾åˆ°`DataCleaner`ç±»ï¼Œåœ¨é‡Œé¢é›†ä¸­ç»´æŠ¤s

> data_cleaner.py
```Python
class DataCleaner:
    def __init__(self):
        return
    def notNull(self,airline_data):  # ç¼ºå¤±å€¼å¤„ç†ï¼šå»é™¤ç¥¨ä»·ä¸ºç©ºçš„è®°å½•
        exp1 = airline_data["SUM_YR_1"].notnull()
        exp2 = airline_data["SUM_YR_2"].notnull()
        exp = exp1 & exp2  # æŒ‰ä½é€»è¾‘ä¸,è·å–æ‰€éœ€çš„å¸ƒå°”å€¼åˆ—è¡¨
        #airline_notnull = airline_data.loc[exp, :]  # expæä¾›å¸ƒå°”å€¼ç«–åˆ—è¡¨ï¼Œ ':'é»˜è®¤æ— å‚æ—¶ï¼Œåˆ‡ç‰‡æ‰€æœ‰è¡Œ,å®Œæˆå»é™¤æ“ä½œ
        airline_notnull = airline_data[exp] #  è¿™æ˜¯ä¸Šä¸€å¥çš„ç®€åŒ–å†™æ³•ï¼ˆä½¿ç”¨æ›´å¤šçš„ç¼ºçœå‚æ•°
        return airline_notnull

    def notOutlier(self,airline_data):
        index1 = airline_data["SUM_YR_1"].notnull()
        index2 = airline_data["SUM_YR_2"] != 0  # æ•ˆæœå’Œä¸Šä¸€å¥çš„notnull()ä¸€æ ·,éƒ½æ˜¯ç”Ÿæˆbool array
        index3 = (airline_data["SEG_KM_SUM"] > 0) & \
                 (airline_data["avg_discount"] != 0)  # æŠ˜æ‰£ä¸”æ€»é‡Œç¨‹ä¸ä¸º0çš„æœºç¥¨
        airline = airline_data[(index1 | index2) & index3]  # ä¸¢å¼ƒç¥¨ä»·ä¸º0ï¼Œæˆ–æŠ˜æ‰£ç‡ä¸º0ï¼Œä¸”æ€»é‡Œç¨‹>0çš„å¼‚å¸¸å€¼
        return airline

```

## RFMåˆ°LFRMCæ¨¡å‹çš„ä»‹ç»

### RFMæ¨¡å‹ä»‹ç»
æœ¬é¡¹ç›®çš„ç›®æ ‡æ˜¯å®¢æˆ·ä»·å€¼åˆ†æï¼Œå³é€šè¿‡èˆªç©ºå…¬å¸å®¢æˆ·æ•°æ®è¯†åˆ«ä¸åŒä»·å€¼çš„å®¢æˆ·ï¼Œè¯†åˆ«å®¢æˆ·ä»·å€¼åº”ç”¨æœ€å¹¿æ³›çš„æ¨¡å‹æ˜¯RFMæ¨¡å‹ã€‚

> + **R**ï¼ˆ`Recency`ï¼‰æŒ‡çš„æ˜¯æœ€è¿‘ä¸€æ¬¡æ¶ˆè´¹æ—¶é—´ä¸æˆªæ­¢æ—¶é—´çš„é—´éš”ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæœ€è¿‘ä¸€æ¬¡æ¶ˆè´¹æ—¶é—´ä¸æˆªæ­¢æ—¶é—´çš„é—´éš”è¶ŠçŸ­ï¼Œå¯¹å³æ—¶æä¾›çš„å•†å“æˆ–æ˜¯æœåŠ¡ä¹Ÿæœ€æœ‰å¯èƒ½æ„Ÿå…´è¶£ã€‚
> + **F**ï¼ˆ`Frequency`ï¼‰æŒ‡é¡¾å®¢åœ¨æŸæ®µæ—¶é—´å†…æ‰€æ¶ˆè´¹çš„æ¬¡æ•°ã€‚å¯ä»¥è¯´æ¶ˆè´¹é¢‘ç‡è¶Šé«˜çš„é¡¾å®¢ï¼Œä¹Ÿæ˜¯æ»¡æ„åº¦è¶Šé«˜çš„é¡¾å®¢ï¼Œå…¶å¿ è¯šåº¦ä¹Ÿå°±è¶Šé«˜ï¼Œé¡¾å®¢ä»·å€¼ä¹Ÿå°±è¶Šå¤§ã€‚
> + **M**ï¼ˆ`Monetary`ï¼‰æŒ‡é¡¾å®¢åœ¨æŸæ®µæ—¶é—´å†…æ‰€æ¶ˆè´¹çš„é‡‘é¢ã€‚æ¶ˆè´¹é‡‘é¢è¶Šå¤§çš„é¡¾å®¢ï¼Œä»–ä»¬çš„æ¶ˆè´¹èƒ½åŠ›è‡ªç„¶ä¹Ÿå°±è¶Šå¤§ï¼Œè¿™å°±æ˜¯æ‰€è°“â€œ20%çš„é¡¾å®¢è´¡çŒ®äº†80%çš„é”€å”®é¢â€çš„äºŒå…«æ³•åˆ™ã€‚

### RFMæ¨¡å‹ç»“æœè§£è¯»

RFMæ¨¡å‹åŒ…æ‹¬ä¸‰ä¸ªç‰¹å¾ï¼Œä½¿ç”¨**ä¸‰ç»´åæ ‡ç³»**è¿›è¡Œå±•ç¤ºï¼Œå¦‚å›¾æ‰€ç¤ºã€‚Xè½´è¡¨ç¤º`Recency`ï¼ŒYè½´è¡¨ç¤º`Frequency`ï¼ŒZè½´è¡¨ç¤º`Monetary`ï¼Œæ¯ä¸ªè½´ä¸€èˆ¬ä¼šåˆ†æˆ5çº§è¡¨ç¤ºç¨‹åº¦ï¼Œ1ä¸ºæœ€å°ï¼Œ5ä¸ºæœ€å¤§

*å¦‚å›¾ï¼Œä¸åŒçš„åŒºåŸŸæœ‰æœ‰ä¸åŒçš„è¥é”€ç­–ç•¥*

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/RFM_model_res.png)

### ä¼ ç»ŸRFMæ¨¡å‹åœ¨èˆªç©ºè¡Œä¸šçš„ç¼ºé™·

åœ¨RFMæ¨¡å‹ä¸­ï¼Œæ¶ˆè´¹é‡‘é¢è¡¨ç¤ºåœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œå®¢æˆ·è´­ä¹°è¯¥ä¼ä¸šäº§å“é‡‘é¢çš„æ€»å’Œï¼Œç”±äºèˆªç©ºç¥¨ä»·å—åˆ°è¿è¾“è·ç¦»ï¼Œèˆ±ä½ç­‰çº§ç­‰å¤šç§å› ç´ å½±å“ï¼ŒåŒæ ·æ¶ˆè´¹é‡‘é¢çš„ä¸åŒæ—…å®¢å¯¹èˆªç©ºå…¬å¸çš„ä»·å€¼æ˜¯ä¸åŒçš„ï¼Œå› æ­¤è¿™ä¸ªç‰¹å¾å¹¶ä¸é€‚åˆç”¨äºèˆªç©ºå…¬å¸çš„å®¢æˆ·ä»·å€¼åˆ†æã€‚

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_RFM_LOw.png)

### èˆªç©ºå®¢æˆ·ä»·å€¼åˆ†æçš„LRFMCæ¨¡å‹
ä¸ºäº†å¼¥è¡¥ä¼ ç»ŸRFMæ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„ç¼ºé™·ï¼Œæœ¬æ¬¡é¡¹ç›®ä½¿ç”¨äº†é€‚ç”¨äºèˆªç©ºå®¢æˆ·ä»·å€¼åˆ†æçš„`LRFMCæ¨¡å‹`

æœ¬é¡¹ç›®é€‰æ‹©å®¢æˆ·åœ¨ä¸€å®šæ—¶é—´å†…ç´¯ç§¯çš„é£è¡Œé‡Œç¨‹Må’Œå®¢æˆ·åœ¨ä¸€å®šæ—¶é—´å†…ä¹˜åèˆ±ä½æ‰€å¯¹åº”çš„æŠ˜æ‰£ç³»æ•°çš„å¹³å‡å€¼Cä¸¤ä¸ªç‰¹å¾ä»£æ›¿æ¶ˆè´¹é‡‘é¢ã€‚æ­¤å¤–ï¼Œèˆªç©ºå…¬å¸ä¼šå‘˜å…¥ä¼šæ—¶é—´çš„é•¿çŸ­åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½å¤Ÿå½±å“å®¢æˆ·ä»·å€¼ï¼Œæ‰€ä»¥åœ¨æ¨¡å‹ä¸­å¢åŠ å®¢æˆ·å…³ç³»é•¿åº¦Lï¼Œä½œä¸ºåŒºåˆ†å®¢æˆ·çš„å¦ä¸€ç‰¹å¾ã€‚

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_LRFMC.png)

## æ„å»ºèˆªç©ºå®¢æˆ·ä»·å€¼åˆ†æçš„å…³é”®ç‰¹å¾

è¿™é‡Œä¾ç„¶ä½¿ç”¨æ¨¡å—å°è£…å’Œç±»å°è£…ï¼Œåœ¨`LRFMC.py`ä¸­å°è£…`LRFMC`ç±»æ¥å®Œæˆæ¨¡å‹ç›¸å…³çš„æ•°æ®å¤„ç†

### é€‰å–å…³é”®ç‰¹å¾ å’Œ æ„å»ºLç‰¹å¾
æˆ‘ä»¬é¦–å…ˆé€‰å–ä¸Šå›¾ç›¸å…³ç‰¹å¾çš„åˆ—åˆ°`airline_selection`ä¸­ï¼Œç”¨äºæ„å»º`L`ç‰¹å¾å’Œåé¢é€‰å–åå››åˆ—ä¸`L`åˆ—åˆå¹¶

> LRFMC.py
```Python
######## æ„å»º LRFMCæ¨¡å‹ ########
import pandas as pd
from log import *

class LRFMC:
    def __init__(self):
        self.log = Log()
        return
    def getFeatures(self,airline):
        # é€‰å–éœ€æ±‚ç‰¹å¾
        airline_selection = airline[["FFP_DATE","LOAD_TIME",
                                     "FLIGHT_COUNT","LAST_TO_END",
                                     "avg_discount","SEG_KM_SUM"]]
        # æ„å»ºLç‰¹å¾
        L = pd.to_datetime(airline_selection["LOAD_TIME"]) \
            - pd.to_datetime(airline_selection["FFP_DATE"])
        self.log(LOG_DEBUG,"\n",L[:5])  #æµ‹è¯•å‰äº”è¡Œ
        # è½¬æˆæœˆä»½
        L = L.astype("str").str.split().str[0]
        L = L.astype("int")/30

        #åˆå¹¶ç‰¹å¾
        airline_features = pd.concat([L,
                airline_selection.iloc[:,2:]],axis = 1)  #axis=1ä½¿å‡½æ•°æŒ‰åˆ—åˆå¹¶,[:,2:]èˆå¼ƒäº†åŸæœ¬çš„å‰ä¸¤åˆ—
        airline_features =airline_features.rename(columns={0:"L"}) # é‡å‘½åæ²¡æœ‰åå­—çš„åˆ—
        self.log(LOG_DEBUG,"\n",airline_features.head())  #ç¼ºçœå‚æ•°ä¸º5ï¼Œæ‰“å°å‰äº”è¡Œ
        return airline_features
```

### æ ‡å‡†åŒ–
å®Œæˆäº”ä¸ªç‰¹å¾çš„æ„å»ºä»¥åï¼Œå¯¹æ¯ä¸ªç‰¹å¾æ•°æ®åˆ†å¸ƒæƒ…å†µè¿›è¡Œåˆ†æï¼Œå…¶æ•°æ®çš„å–å€¼èŒƒå›´å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ä»è¡¨ä¸­æ•°æ®å¯ä»¥å‘ç°ï¼Œ**äº”ä¸ªç‰¹å¾çš„å–å€¼èŒƒå›´æ•°æ®å·®å¼‚è¾ƒå¤§**ï¼Œä¸ºäº†æ¶ˆé™¤æ•°é‡çº§æ•°æ®å¸¦æ¥çš„å½±å“ï¼Œéœ€è¦å¯¹æ•°æ®åš`æ ‡å‡†åŒ–å¤„ç†`ã€‚

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_Stadert_table.png)

è¿™é‡Œä½¿ç”¨ `sklearn`æ¨¡å—ä¸­çš„ `StandardScaler`ç±»æ¥è‡ªåŠ¨æ ‡å‡†åŒ–æ•°æ®ï¼Œç„¶åæˆ‘ä»¬å°†æ ‡å‡†åŒ–åçš„æ•°æ®å†è½¬æˆ`pandas`è¡¨æ ¼ï¼Œæœ€åå‚¨å­˜åˆ°ä¸´æ—¶æ–‡ä»¶`airline_scale.xlsx`ä¸­

> LRFMC.py
```Python
    def storeStandData(self,airline_features):
        data = StandardScaler().fit_transform(airline_features)
        SDF = pd.DataFrame(data);  #è·å– standardDataFrame(SDF)
        SDF = SDF.rename(columns={0:"L",1:"F",2:"R",3:"C",4:"M"})
        self.log(LOG_INFO,"æ ‡å‡†åŒ–åçš„å‰äº”è¡Œçš„LRFMCäº”ä¸ªç‰¹å¾ä¸º\n",SDF.head())
        SDF.to_excel("../tmp/airline_scale.xlsx")  ##å‚¨å­˜å€¼tmpæ–‡ä»¶å¤¹
```

å‰äº”è¡Œæ ‡å‡†åŒ–å‰åçš„ç»“æœå¦‚ä¸‹

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/acva_sta_raw.png)

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_STA.png)

## äº†è§£å’Œä½¿ç”¨`K-Means`èšç±»ç®—æ³•
å³ä½¿ç»è¿‡äº†ä¸€ç³»åˆ—é¢„å¤„ç†å’Œæ¨¡å‹å»ºæ¨¡ï¼Œæˆ‘ä»¬æ‰‹ä¸Šçš„æ•°æ®ä¾ç„¶è¿˜æ˜¯æ¯”è¾ƒåŸå§‹ï¼Œåªæœ‰ç»è¿‡åˆ†ç±»è¿‡çš„æ•°æ®æ‰æ›´æœ‰åˆ†æä»·å€¼ï¼Œè€Œè‡ªç„¶æ•°æ®ä¸€èˆ¬éƒ½éš¾ä»¥ç›´æ¥åˆ†ç±»ï¼Œéœ€è¦ç”¨èšç±»ç®—æ³•è¿›è¡Œåˆ†ç±»ï¼Œè¿™é‡Œå°±ç”¨åˆ°äº†`K-Means`èšç±»ç®—æ³•

### åŸºæœ¬æ¦‚å¿µ
K-Meansèšç±»ç®—æ³•æ˜¯ä¸€ç§åŸºäºè´¨å¿ƒçš„åˆ’åˆ†æ–¹æ³•ï¼Œè¾“å…¥èšç±»ä¸ªæ•°kï¼Œä»¥åŠåŒ…å«nä¸ªæ•°æ®å¯¹è±¡çš„æ•°æ®åº“ï¼Œè¾“å‡ºæ»¡è¶³è¯¯å·®å¹³æ–¹å’Œæœ€å°æ ‡å‡†çš„kä¸ªèšç±»ã€‚ç®—æ³•æ­¥éª¤å¦‚ä¸‹:

+ ä»nä¸ªæ ·æœ¬æ•°æ®ä¸­éšæœºé€‰å–kä¸ªå¯¹è±¡ä½œä¸ºåˆå§‹çš„èšç±»ä¸­å¿ƒã€‚
+ åˆ†åˆ«è®¡ç®—æ¯ä¸ªæ ·æœ¬åˆ°å„ä¸ªèšç±»è´¨å¿ƒçš„è·ç¦»ï¼Œå°†æ ·æœ¬åˆ†é…åˆ°è·ç¦»æœ€è¿‘çš„é‚£ä¸ªèšç±»ä¸­å¿ƒç±»åˆ«ä¸­ã€‚
+ æ‰€æœ‰æ ·æœ¬åˆ†é…å®Œæˆåï¼Œé‡æ–°è®¡ç®—kä¸ªèšç±»çš„ä¸­å¿ƒã€‚
+ ä¸å‰ä¸€æ¬¡è®¡ç®—å¾—åˆ°çš„kä¸ªèšç±»ä¸­å¿ƒæ¯”è¾ƒï¼Œå¦‚æœèšç±»ä¸­å¿ƒå‘ç”Ÿå˜åŒ–ï¼Œè½¬(2)ï¼Œå¦åˆ™è½¬(5)ã€‚
+ å½“è´¨å¿ƒä¸å‘ç”Ÿå˜åŒ–æ—¶åœæ­¢å¹¶è¾“å‡ºèšç±»ç»“æœã€‚

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_KMEANS.png)

### æ•°æ®ç±»å‹
K-Meansèšç±»ç®—æ³•æ˜¯åœ¨æ•°å€¼ç±»å‹æ•°æ®çš„åŸºç¡€ä¸Šè¿›è¡Œç ”ç©¶ï¼Œç„¶è€Œæ•°æ®åˆ†æçš„æ ·æœ¬å¤æ‚å¤šæ ·ï¼Œå› æ­¤è¦æ±‚ä¸ä»…èƒ½å¤Ÿå¯¹ç‰¹å¾ä¸ºæ•°å€¼ç±»å‹çš„æ•°æ®è¿›è¡Œåˆ†æï¼Œè¿˜è¦é€‚åº”æ•°æ®ç±»å‹çš„å˜åŒ–ï¼Œå¯¹ä¸åŒç‰¹å¾åšä¸åŒå˜æ¢ï¼Œä»¥æ»¡è¶³ç®—æ³•çš„è¦æ±‚ã€‚

### è·å–KMeanså¯¹è±¡
sklearnçš„clusteræ¨¡å—æä¾›äº†KMeanså‡½æ•°æ„å»ºK-Meansèšç±»æ¨¡å‹

ç¿»é˜…å…¶æºä»£ç (ä¸‹å›¾)ï¼Œå¯ä»¥çœ‹åˆ°`KMeans`æ˜¯ä¸€ä¸ª**ç±»**ï¼Œä¸”æ„é€ å‡½æ•°æœ‰å¤§é‡ç¼ºçœå‚æ•°ï¼Œå› æ­¤å®ä¾‹åŒ–`KMeans`å¯¹è±¡æ—¶ï¼Œåªéœ€æä¾›æ— ç¼ºçœçš„å‚æ•°ï¼Œå’Œè°ƒæ•´å…³é”®ç¼ºçœå‚æ•°å³å¯

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/K-Means_org.png)

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_Kmeans_para.png)

è¿™é‡Œæˆ‘ä»¬åªæ˜¾å¼ä¼ å‚`n_clusters`å’Œ`random_state`,å…¶ä¸­åä¸€ä¸ªå‚æ•°ç”¨æ—¶é—´æˆ³

å› ä¸ºæœ¬èº«`KMeans`å°±å°è£…åœ°å¾ˆå¥½ï¼Œè¿™éƒ¨åˆ†ä»£ç å°±å†™åœ¨`main.py`çš„ä¸»é€»è¾‘ä¸­

> main.py
```Python
    ## å¯¹è±¡å®ä¾‹åŒ–
    k = 5 ## ç¡®å®šèšç±»ä¸­å¿ƒæ•°ï¼Œè¿™é‡Œæˆ‘ä»¬é¢„æœŸèšç±»5ç±»å®¢æˆ·
    kmeans_model = KMeans(n_clusters=k,random_state=int(time.time()))  # å®ä¾‹åŒ–å¯¹è±¡
    kmeans_model = kmeans_model.fit(airline_scale)  # ç”¨å‡†å¤‡å¥½çš„æ•°æ®è®­ç»ƒæ¨¡å‹
    centers = kmeans_model.cluster_centers_
    log(LOG_INFO,"äº”ä¸ªèšç±»ä¸­å¿ƒä¸º\n",centers)

    ## ç»Ÿè®¡ä¸åŒç±»åˆ«æ ·æœ¬çš„æ•°ç›®
    r1 = pd.Series(kmeans_model.labels_).value_counts()
    log(LOG_INFO,"æœ€ç»ˆæ¯ä¸ªç±»åˆ«çš„æ•°ç›®ä¸º\n",r1)
```

æœ€åèšç±»çš„ç»“æœç±»ä¼¼ä¸‹è¡¨

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_CLUSTER_RES.png)

è‡³æ­¤æ•°æ®çš„åˆ†æï¼Œå»ºæ¨¡å’Œèšç±»å·²ç»å®Œæˆï¼Œæ•°æ®å¤„ç†éƒ¨åˆ†å‘Šä¸€æ®µè½ï¼Œæ¥ä¸‹æ¥æ˜¯å¯è§†åŒ–å¤„ç†

## å¯è§†åŒ–é›·è¾¾å›¾

è¿™é‡Œä½¿ç”¨`matplotlib.pyplot`æ¨¡å—ä½œå›¾ï¼Œ`numpy`äºŒæ¬¡å¤„ç†æ•°æ®,å°è£…ä»£ç åˆ°`RadarDrawer`ç±»ä¸­å¹¶ç”¨`__call__`é‡è½½`()`æ“ä½œç¬¦

å€¼å¾—æ³¨æ„çš„æ˜¯:

+ å› ä¸ºè¿™é‡Œä½¿ç”¨äº†é›·è¾¾å›¾ï¼Œæ‰€ä»¥ç»˜åˆ¶å›¾å½¢æ—¶ä½¿ç”¨`æåæ ‡`ä¼šæ›´æ–¹ä¾¿
+ å› ä¸ºè¿™é‡Œä½¿ç”¨äº†ä¸­æ–‡æ–‡å­—ï¼Œè€Œé»˜è®¤å­—ä½“ä¸æ”¯æŒä¸­æ–‡ï¼Œä¼šæŠ¥é”™ï¼Œæ‰€ä»¥è¦**æå‰è®¾ç½®ä¸­æ–‡å­—ä½“**

> radar_chart.py
```Python
import matplotlib.pyplot as plt
import numpy as np

class RadarDrawer():
    def __init__(self):
        return

    def __call__(self, kmeans_moudel, n_clusters):
        # è®¾ç½®æ”¯æŒä¸­æ–‡çš„å­—ä½“
        plt.rc("font",family="Microsoft YaHei")
        # æ ‡ç­¾
        labels = np.array([u'ZL',u'ZR',u'ZF',u'ZM',u'ZC'])

        plot_data = kmeans_moudel.cluster_centers_
        # æŒ‡å®šé¢œè‰²
        color = ['b','g','r','c','y']
        # è®¡ç®—é›·è¾¾å›¾çš„è§’åº¦
        angles = np.linspace(0,2*np.pi,n_clusters,endpoint=False)

        # é—­åˆ(é¦–å°¾åˆ—ç›¸åŒ) å¹¶ç”¨npæŠŠpandasçš„DataFrameè½¬æˆåŸç”Ÿæ•°ç»„
        plot_data = np.concatenate((plot_data,plot_data[:,[0]]),axis = 1)
        angles_org = angles
        angles = np.concatenate((angles,[angles[0]]))

        fig = plt.figure(figsize=(6,6),dpi = 160)
        #polarå‚æ•°
        ax = fig.add_subplot(111, polar=True)  # è®¾ç½®åæ ‡ä¸ºæåæ ‡
        # ç”»è‹¥å¹²ä¸ªäº”è¾¹å½¢
        floor = np.floor(plot_data.min())   # å¤§äºæœ€å°å€¼çš„æœ€å¤§æ•´æ•°
        ceil = np.ceil(plot_data.max())     # å°äºæœ€å°å€¼çš„æœ€å°æ•´æ•°
        n = len(labels)
        for i in np.arange(floor,ceil+0.5, 0.5):
            ax.plot(angles,[i] *(n+1),'-.',lw=0.5,color='black')
        # è¯ä¸åŒå®¢æˆ·ç¾¤çš„åˆ†å‰²çº¿
        for i in range(len(plot_data)):
            ax.plot(angles,plot_data[i],color = color[i],
                    label='å®¢æˆ·ç¾¤'+str(i+1),linewidth=2, linestyle='-.')
        ax.set_rgrids(np.arange(0,2.5, 0.5))  # ç”»å‡ºæ¯å±‚çš„æƒé‡
        ax.set_thetagrids(angles_org* 180/np.pi,labels)  # è®¾ç½®æ˜¾ç¤ºçš„è§’åº¦ä¸ºåº¦æ•°åˆ¶
        plt.legend(loc='lower right',bbox_to_anchor=(1.1, -0.1))  #è®¾ç½®å›¾ä¾‹ä½ç½®åœ¨ç”»å¸ƒå¤–
        #plt.legend()

        #ax.set_theta_zero_location('N')         # è®¾ç½®æåæ ‡çš„èµ·ç‚¹ï¼ˆå³0Â°ï¼‰åœ¨æ­£åŒ—æ–¹å‘
        ax.spines['polar'].set_visible(False)   # ä¸æ˜¾ç¤ºæåæ ‡æœ€å¤–é¢çš„åœˆ
        ax.grid(False)                          # ä¸æ˜¾ç¤ºé»˜è®¤åˆ†å‰²çº¿
        plt.savefig("../tmp/ACVA_img.png")      # å‚¨å­˜å›¾åƒçš„ä¸´æ—¶æ–‡ä»¶
        plt.show()
```

## é‡æ–°ç»„ç»‡main.py

è‡³æ­¤æ‰€æœ‰çš„åŠŸèƒ½å·²ç»å®ç°ï¼Œå¹¶å°è£…åˆ°äº†å„ä¸ªæ¨¡å—å’Œç±»ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å†é‡æ–°ç»„ç»‡ä¸€æ¬¡`main.py`ï¼Œå¹¶æœ€ç»ˆå®šæ¡£å…¶ä¸­çš„ä»£ç 

> main.py
```Python
######### ä¸»ç¨‹åºå…¥å£ #############
import pandas as pd
from sklearn.cluster import KMeans
import time

from log import *
from data_clean import *
from LRFMC import *
from radar_chart import  *

if __name__ == '__main__':

    log = Log()  # å®ä¾‹åŒ–ä¸€ä¸ªæ—¥å¿—å™¨
    data_cleaner = DataCleaner() #å®ä¾‹åŒ–æ•°æ®æ¸…æ´—å™¨
    LRFMCobj = LRFMC() # å®ä¾‹åŒ–æ¨¡å‹å¤„ç†å™¨

    # ä»æ•°æ®æºè·å–æ•°æ®
    airline_data = pd.read_csv("../data_raw/air_data.csv",
        encoding="gb18030")  # å¯¼å…¥èˆªç©ºæ•°æ®
    log(LOG_INFO,'åŸå§‹æ•°æ®çš„å½¢çŠ¶ä¸ºï¼š', airline_data.shape)

    #æ•°æ®é¢„å¤„ç†
    ## ç¼ºå¤±å€¼å¤„ç†ï¼šå»é™¤ç¥¨ä»·ä¸ºç©ºçš„è®°å½•
    airline_notnull = data_cleaner.notNull(airline_data)
    log(LOG_INFO,'åˆ é™¤ç¼ºå¤±è®°å½•åæ•°æ®çš„å½¢çŠ¶ä¸ºï¼š', airline_notnull.shape)

    ## å¼‚å¸¸å€¼å¤„ç†: åªä¿ç•™ç¥¨ä»·éé›¶çš„ï¼Œæˆ–è€…å¹³å‡æŠ˜æ‰£ç‡ä¸ä¸º0ä¸”æ€»é£è¡Œå…¬é‡Œæ•°å¤§äº0çš„è®°å½•ã€‚
    airline = data_cleaner.notOutlier(airline_notnull)
    log(LOG_INFO,'åˆ é™¤å¼‚å¸¸è®°å½•åæ•°æ®çš„å½¢çŠ¶ä¸ºï¼š', airline.shape)

    # æ„å»ºLRFMCäº”å¤§ç‰¹å¾
    airline_features = LRFMCobj.getFeatures(airline)
    LRFMCobj.storeStandData(airline_features)

    # è·å–KMeanså¯¹è±¡
    ## å‡†å¤‡æ•°æ®
    airline_scale = pd.read_excel("../tmp/airline_scale.xlsx")
    airline_scale = airline_scale.iloc[:,1:]  # åˆ‡æ‰ç¬¬ä¸€åˆ—çš„ä½œä¸ºè¡Œæ•°æ ‡å¿—çš„æ•°å­—

    ## å¯¹è±¡å®ä¾‹åŒ–
    k = 5 ## ç¡®å®šèšç±»ä¸­å¿ƒæ•°ï¼Œè¿™é‡Œæˆ‘ä»¬é¢„æœŸèšç±»5ç±»å®¢æˆ·
    kmeans_model = KMeans(n_clusters=k,random_state=int(time.time()))  # å®ä¾‹åŒ–å¯¹è±¡
    kmeans_model = kmeans_model.fit(airline_scale)  # ç”¨å‡†å¤‡å¥½çš„æ•°æ®è®­ç»ƒæ¨¡å‹
    centers = kmeans_model.cluster_centers_
    log(LOG_INFO,"äº”ä¸ªèšç±»ä¸­å¿ƒä¸º\n",centers)

    ## ç»Ÿè®¡ä¸åŒç±»åˆ«æ ·æœ¬çš„æ•°ç›®
    r1 = pd.Series(kmeans_model.labels_).value_counts()
    log(LOG_INFO,"æœ€ç»ˆæ¯ä¸ªç±»åˆ«çš„æ•°ç›®ä¸º\n",r1)

    # ä½œå‡ºå›¾æ ·
    RadarDrawer()(kmeans_model,n_clusters=k)
    log(LOG_INFO,"å®Œæˆä½œå›¾")
```

å¯ä»¥çœ‹åˆ°ï¼Œç»è¿‡ä¸€ç³»åˆ—å°è£…ï¼Œ`main.py`åªæœ‰å¯¥å¯¥50å¤šè¡Œï¼Œç¡®å·²ç»ä½“ç°äº†ä¸»è¦çš„ ä¸šåŠ¡é€»è¾‘

# åˆ†æèšç±»ç»“æœ

![](https://picbed0521.oss-cn-shanghai.aliyuncs.com/blogpic/ACVA_output.png)

åŸºäºç‰¹å¾æè¿°ï¼Œæœ¬é¡¹ç›®å®šä¹‰äº”ä¸ªç­‰çº§çš„å®¢æˆ·ç±»åˆ«ï¼šé‡è¦ä¿æŒå®¢æˆ·ï¼Œé‡è¦å‘å±•å®¢æˆ·ï¼Œé‡è¦æŒ½ç•™å®¢æˆ·ï¼Œä¸€èˆ¬å®¢æˆ·ï¼Œä½ä»·å€¼å®¢æˆ·

# æ¨¡å‹åº”ç”¨
æ ¹æ®å¯¹å„ä¸ªå®¢æˆ·ç¾¤è¿›è¡Œç‰¹å¾åˆ†æï¼Œé‡‡å–ä¸‹é¢çš„ä¸€äº›è¥é”€æ‰‹æ®µå’Œç­–ç•¥ï¼Œä¸ºèˆªç©ºå…¬å¸çš„ä»·å€¼å®¢æˆ·ç¾¤ç®¡ç†æä¾›å‚è€ƒ

+ `ä¼šå‘˜çš„å‡çº§ä¸ä¿çº§`ï¼šèˆªç©ºå…¬å¸å¯ä»¥åœ¨å¯¹ä¼šå‘˜å‡çº§æˆ–ä¿çº§è¿›è¡Œè¯„ä»·çš„æ—¶é—´ç‚¹ä¹‹å‰ï¼Œå¯¹é‚£äº›æ¥è¿‘ä½†å°šæœªè¾¾åˆ°è¦æ±‚çš„è¾ƒé«˜æ¶ˆè´¹å®¢æˆ·è¿›è¡Œé€‚å½“æé†’ç”šè‡³é‡‡å–ä¸€äº›ä¿ƒé”€æ´»åŠ¨ï¼Œåˆºæ¿€ä»–ä»¬é€šè¿‡æ¶ˆè´¹è¾¾åˆ°ç›¸åº”æ ‡å‡†ã€‚è¿™æ ·æ—¢å¯ä»¥è·å¾—æ”¶ç›Šï¼ŒåŒæ—¶ä¹Ÿæé«˜äº†å®¢æˆ·çš„æ»¡æ„åº¦ï¼Œå¢åŠ äº†å…¬å¸çš„ç²¾è‹±ä¼šå‘˜ã€‚
+ `é¦–æ¬¡å…‘æ¢`ï¼šé‡‡å–çš„æªæ–½æ˜¯ä»æ•°æ®åº“ä¸­æå–å‡ºæ¥è¿‘ä½†å°šæœªè¾¾åˆ°é¦–æ¬¡å…‘æ¢æ ‡å‡†çš„ä¼šå‘˜ï¼Œå¯¹ä»–ä»¬è¿›è¡Œæé†’æˆ–ä¿ƒé”€ï¼Œä½¿ä»–ä»¬é€šè¿‡æ¶ˆè´¹è¾¾åˆ°æ ‡å‡†ã€‚ä¸€æ—¦å®ç°äº†é¦–æ¬¡å…‘æ¢ï¼Œå®¢æˆ·åœ¨æœ¬å…¬å¸è¿›è¡Œå†æ¬¡æ¶ˆè´¹å…‘æ¢å°±æ¯”åœ¨å…¶ä»–å…¬å¸è¿›è¡Œå…‘æ¢è¦å®¹æ˜“è®¸å¤šï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šç­‰äºæé«˜äº†è½¬ç§»çš„æˆæœ¬ã€‚
+ `äº¤å‰é”€å”®`ï¼šé€šè¿‡å‘è¡Œè”åå¡ç­‰ä¸éèˆªç©ºç±»ä¼ä¸šçš„åˆä½œï¼Œä½¿å®¢æˆ·åœ¨å…¶ä»–ä¼ä¸šçš„æ¶ˆè´¹è¿‡ç¨‹ä¸­è·å¾—æœ¬å…¬å¸çš„ç§¯åˆ†ï¼Œå¢å¼ºä¸å…¬å¸çš„è”ç³»ï¼Œæé«˜ä»–ä»¬çš„å¿ è¯šåº¦ã€‚

# å°ç»“
æœ¬é¡¹ç›®ç»“åˆèˆªç©ºå…¬å¸å®¢æˆ·ä»·å€¼åˆ†æçš„æ¡ˆä¾‹ï¼Œé‡ç‚¹ä»‹ç»äº†æ•°æ®åˆ†æç®—æ³•ä¸­K-Meansèšç±»ç®—æ³•åœ¨å®¢æˆ·ä»·å€¼åˆ†æä¸­çš„åº”ç”¨ã€‚é’ˆå¯¹RFMå®¢æˆ·ä»·å€¼åˆ†ææ¨¡å‹çš„ä¸è¶³ï¼Œä½¿ç”¨K-Meansç®—æ³•æ„å»ºäº†èˆªç©ºå®¢æˆ·ä»·å€¼åˆ†æLRFMCæ¨¡å‹ï¼Œè¯¦ç»†æè¿°äº†æ•°æ®åˆ†æçš„æ•´ä¸ªè¿‡ç¨‹ã€‚

# githubé¡¹ç›®æ–‡ä»¶ å’Œ ç›¸å…³å¤–éƒ¨é“¾æ¥
[æˆ³æˆ‘å»githubä»“åº“ğŸ”—](https://github.com/sis-shen/ACVA)

[æˆ³æˆ‘å»KMeansæºç ğŸ”—](https://github.com/scikit-learn/scikit-learn/blob/fd237278e/sklearn/cluster/_kmeans.py#L745)

[æˆ³æˆ‘å»pandasæ–‡æ¡£ä¸‹è½½ğŸ”—](https://pandas.pydata.org/docs/)

[æˆ³æˆ‘å»matplotlibçš„APIæ–‡æ¡£ğŸ”—](https://matplotlib.org/stable/api/index)

[æˆ³æˆ‘å»numpyæ–‡æ¡£ğŸ”—](https://numpy.org/doc/stable/)